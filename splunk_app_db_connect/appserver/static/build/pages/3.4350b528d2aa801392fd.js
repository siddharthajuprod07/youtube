webpackJsonp([3],{"views/shared/singlevalue/Master":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),module,__webpack_require__("views/shared/viz/Base"),__webpack_require__("views/shared/singlevalue/Sparkline"),__webpack_require__("views/shared/singlevalue/MainBody"),__webpack_require__("views/shared/singlevalue/UnderLabel"),__webpack_require__("models/Base"),__webpack_require__("shim/splunk.util"),__webpack_require__("util/svg"),__webpack_require__("uri/route"),__webpack_require__("util/drilldown"),__webpack_require__("util/time"),__webpack_require__("util/color_utils"),__webpack_require__("util/general_utils"),__webpack_require__("util/moment/relative"),__webpack_require__("util/theme_utils"),__webpack_require__("util/numeral"),__webpack_require__("splunk/palettes/ColorCodes")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,module,VisualizationBase,Sparkline,MainBodyView,UnderLabelView,BaseModel,splunkUtil,svgUtil,route,drilldownUtil,timeUtil,colorUtil,generalUtil,relativeMomentUtil,themeUtils,numeral,ColorCodes){var THEMES={enterprise:{SEVERITY_COLORS:{severe:ColorCodes.SEMANTIC_BY_NAME.error,high:ColorCodes.SEMANTIC_BY_NAME.alert,elevated:ColorCodes.SEMANTIC_BY_NAME.warning,guarded:ColorCodes.SEMANTIC_BY_NAME.info,low:ColorCodes.SEMANTIC_BY_NAME.success,none:ColorCodes.DARK_GREY},SEVERITIES:["none","low","guarded","elevated","high","severe"],BLOCK_DEFAULT_FONT_COLOR:"#FFFFFF",BLOCK_DEFAULT_BACKGROUND_COLOR:"#333333",DEFAULT_FONT_COLOR:"#333333",DEFAULT_BACKGROUND_COLOR:"#FFFFFF",UNDERLABEL_COLOR:ColorCodes.DARK_GREY,NEUTRAL_CHANGE_COLOR:ColorCodes.DARK_GREY,NEUTRAL_CHANGE_BACKGROUND_COLOR:ColorCodes.DARK_GREY,DELTA_GREEN:ColorCodes.SEMANTIC_BY_NAME.success,DELTA_RED:ColorCodes.SEMANTIC_BY_NAME.error,EDGE_PADDING:32,NEUTRAL_SPARKLINE_COLOR:"#999999"},dark:{SEVERITY_COLORS:{severe:ColorCodes.SEMANTIC_BY_NAME.error,high:ColorCodes.SEMANTIC_BY_NAME.alert,elevated:ColorCodes.SEMANTIC_BY_NAME.warning,guarded:ColorCodes.SEMANTIC_BY_NAME.info,low:ColorCodes.SEMANTIC_BY_NAME.success,none:"#FFFFFF"},SEVERITIES:["none","low","guarded","elevated","high","severe"],BLOCK_DEFAULT_FONT_COLOR:"#FFFFFF",BLOCK_DEFAULT_BACKGROUND_COLOR:"#212527",DEFAULT_FONT_COLOR:"#FFFFFF",DEFAULT_BACKGROUND_COLOR:"#212527",UNDERLABEL_COLOR:"#C3CBD4",NEUTRAL_CHANGE_COLOR:"#FFFFFF",NEUTRAL_CHANGE_BACKGROUND_COLOR:"#212527",DELTA_GREEN:ColorCodes.SEMANTIC_BY_NAME.success,DELTA_RED:ColorCodes.SEMANTIC_BY_NAME.error,EDGE_PADDING:32,NEUTRAL_SPARKLINE_COLOR:"#FFFFFF"}};return VisualizationBase.extend(_.extend({moduleId:module.id,className:"single-value",MAX_RESULT_COUNT:1e3,initialize:function(options){VisualizationBase.prototype.initialize.apply(this,arguments),this.$el.width(this.options.width||"100%"),this.$el.height(this.options.height||"100%"),this.$el.css("position","relative"),this.getPrimaryDataSource()?(this.model.searchData=this.getPrimaryDataSource().searchResults,this.model.searchDataParams=this.getPrimaryDataSource().fetchParams):this.listenTo(this.model.searchData,"change",this.onDataChange),this.model.results=new BaseModel({searchResultsColumn:this.model.searchData,resultField:"",resultFieldValue:""}),this.model.presentation=new BaseModel,this.updateContainerDimensions(),this.originalHeight=this.$el.height(),this.model.presentation.set({fontColor:this.getFontColor(),scaleRatio:1,edgePadding:this.EDGE_PADDING}),this.$inlineMessage=$('<div class="inline-message"></div>').css({"text-align":"center",height:"32px",width:"100%",position:"absolute",bottom:"0"}).addClass(this.options.messageContainerClass||"")},getRequiredDataSources:function(){return[]},onConfigChange:function(changedAttributes){var shouldInvalidate=_(changedAttributes).chain().keys().any(function(key){return 0===key.indexOf("display.visualizations.singlevalue.")}).value();shouldInvalidate&&this.invalidate("formatDataPass")},updateResultState:function(){var sparklineData,sparklineColor,deltaIndicatorColor,resultField=this.determineResultFieldName(this.model.config.get("display.visualizations.singlevalue.field")),resultFieldValue=this.getFieldValue(resultField);this.model.results.set("resultField",resultField),this.model.results.set("resultFieldValue",resultFieldValue),this.isTimeSeries()&&!isNaN(resultFieldValue)?(sparklineData=this.getFieldValues(resultField),this.model.results.set("sparkline",sparklineData),this.setDeltaValue(resultFieldValue),this.model.config.set("is_timeseries",!0,{"transient":!0})):(this.model.results.unset("sparkline"),this.model.results.unset("deltaValue"),this.model.results.unset("deltaBacktrack"),this.model.config.set("is_timeseries",!1,{"transient":!0})),this.severityColor=this.getSeverityColor(resultFieldValue),this.severityBackgroundColor=this.getSeverityColor(resultFieldValue,{isBackground:!0}),this.deltaColor=this.getDeltaColor(),this.deltaBackgroundColor=this.getDeltaColor({isBackground:!0}),deltaIndicatorColor=this.getDeltaIndicatorColor(),sparklineColor=this.useColors()&&"trend"===this.model.config.get("display.visualizations.singlevalue.colorBy")||this.hasBackground()?deltaIndicatorColor:this.NEUTRAL_SPARKLINE_COLOR,this.model.presentation.set("deltaColor",deltaIndicatorColor),this.model.presentation.set("sparklineColor",sparklineColor),this.model.presentation.set("fontColor",this.getFontColor()),this.model.presentation.set("formatPattern",this.getFormatPattern())},getDeltaColor:function(options){var deltaMode=this.model.config.get("display.visualizations.singlevalue.trendColorInterpretation")||"standard",deltaValue=this.model.results.get("deltaValue"),deltaIncreased="percentageIncrease"===deltaValue||deltaValue>0;return 0===deltaValue?options&&options.isBackground?this.NEUTRAL_CHANGE_BACKGROUND_COLOR:this.NEUTRAL_CHANGE_COLOR:"inverse"===deltaMode?deltaIncreased?this.DELTA_RED:this.DELTA_GREEN:deltaIncreased?this.DELTA_GREEN:this.DELTA_RED},getSeverityColor:function(resultFieldValue,options){var parsedRanges,parsedColors,colorsDefined,severities,ranges=this.model.config.get("display.visualizations.singlevalue.rangeValues"),colors=this.model.config.get("display.visualizations.singlevalue.rangeColors"),useColors=splunkUtil.normalizeBoolean(this.model.config.get("display.visualizations.singlevalue.useColors"))||!1,defaultColor=options&&options.isBackground?this.BLOCK_DEFAULT_BACKGROUND_COLOR:this.DEFAULT_FONT_COLOR,rangeMapValue=this.getResultField("range");if(rangeMapValue&&!useColors)return this.SEVERITY_COLORS[rangeMapValue]||defaultColor;if(ranges){if(parsedRanges=generalUtil.stringToArray(ranges),parsedColors=generalUtil.stringToArray(colors),colorsDefined=parsedColors.length>0,0===parsedRanges.length||isNaN(resultFieldValue))return defaultColor;severities=this.SEVERITIES.slice(1,6);for(var i=0;i<parsedRanges.length;i++){if(isNaN(parsedRanges[i]))return defaultColor;if(parseFloat(resultFieldValue)<=parseFloat(parsedRanges[i]))return colorsDefined?colorUtil.replaceSymbols(parsedColors[i],"#")||defaultColor:this.SEVERITY_COLORS[severities[i]]}return colorsDefined?colorUtil.replaceSymbols(parsedColors[parsedRanges.length],"#")||defaultColor:this.SEVERITY_COLORS[severities[severities.length-1]]}return defaultColor},getDeltaIndicatorColor:function(){var colorBy=this.model.config.get("display.visualizations.singlevalue.colorBy");return this.hasBackground()?this.BLOCK_DEFAULT_FONT_COLOR:"value"!==colorBy&&this.useColors()?this.deltaColor:this.DEFAULT_FONT_COLOR},getFontColor:function(){var colorBy=this.model.config.get("display.visualizations.singlevalue.colorBy");return this.hasBackground()?this.BLOCK_DEFAULT_FONT_COLOR:"trend"===colorBy&&this.isTimeSeries()||!this.useColors()?this.DEFAULT_FONT_COLOR:this.severityColor},useColors:function(){var useColors=splunkUtil.normalizeBoolean(this.model.config.get("display.visualizations.singlevalue.useColors"))||!1,rangeMapValue=this.getFieldValues("range");return!(!rangeMapValue||useColors)||useColors},hasBackground:function(){var backgroundMode=this.model.config.get("display.visualizations.singlevalue.colorMode");return"block"===backgroundMode&&this.useColors()&&this.getBackgroundColor()},getBackgroundColor:function(){var colorBy=this.model.config.get("display.visualizations.singlevalue.colorBy");return this.useColors()?"trend"===colorBy?this.deltaBackgroundColor:this.severityBackgroundColor:this.BLOCK_DEFAULT_BACKGROUND_COLOR},getFormatPattern:function(){var matchedPrecision,decimalPlaces,formatPattern="0",numberPrecision=this.model.config.get("display.visualizations.singlevalue.numberPrecision"),useThousandSeparators=splunkUtil.normalizeBoolean(this.model.config.get("display.visualizations.singlevalue.useThousandSeparators"));return useThousandSeparators!==!1&&(formatPattern+=",0"),numberPrecision&&(matchedPrecision=numberPrecision.match(/^0\.?(0*)$/),matchedPrecision&&2===matchedPrecision.length&&(decimalPlaces=matchedPrecision[1],decimalPlaces.length>4&&(decimalPlaces="0000"),decimalPlaces.length>0&&(formatPattern=formatPattern+"."+decimalPlaces))),formatPattern},setDeltaValue:function(currentValue){var parsedTimeArr,parsedTime,deltaValue,deltaBacktrack,formattedDeltaValue,timeToBacktrackInSeconds,dataPointsToBacktrack,mostRecentDate,secondMostRecentDate,deltaDate,timeGranularityInSeconds,timeAmount,timeUnit,deltaTimeRange=this.model.config.get("display.visualizations.singlevalue.trendInterval"),deltaFormat=this.model.config.get("display.visualizations.singlevalue.trendDisplayMode"),times=this.getFieldValues("_time"),resultField=this.model.results.get("resultField"),formatPattern=this.getFormatPattern(),createRecentDateObject=function(offset){return timeUtil.bdTimeToDateObject(timeUtil.extractBdTime(times[times.length-offset]))};if(deltaTimeRange&&"auto"!==deltaTimeRange){try{parsedTimeArr=relativeMomentUtil.parseRelativeTimeExpression(deltaTimeRange)}catch(err){return}if(parsedTimeArr&&parsedTimeArr[0]&&(parsedTime=parsedTimeArr[0]),times.length>=2&&parsedTime&&parsedTime.unit&&!isNaN(parsedTime.amount)){if(timeUnit=timeUtil.normalizeUnit(parsedTime.unit),timeAmount=Math.abs(parsedTime.amount),mostRecentDate=createRecentDateObject(1),deltaDate=createRecentDateObject(1),secondMostRecentDate=createRecentDateObject(2),timeGranularityInSeconds=(mostRecentDate.getTime()-secondMostRecentDate.getTime())/1e3,_.indexOf(["s","m","h"],timeUnit)!==-1)timeToBacktrackInSeconds=timeUtil.convertAmountAndUnitToSeconds(timeAmount,timeUnit);else{switch(timeUnit){case"y":deltaDate.setFullYear(deltaDate.getFullYear()-timeAmount);break;case"q":deltaDate.setMonth(deltaDate.getMonth()-3*timeAmount);break;case"mon":deltaDate.setMonth(deltaDate.getMonth()-timeAmount);break;case"w":deltaDate.setDate(deltaDate.getDate()-7*timeAmount);break;case"d":deltaDate.setDate(deltaDate.getDate()-timeAmount);break;default:return deltaDate=void 0}deltaDate&&(timeToBacktrackInSeconds=(mostRecentDate.getTime()-deltaDate)/1e3)}timeToBacktrackInSeconds&&(dataPointsToBacktrack=Math.round(timeToBacktrackInSeconds/timeGranularityInSeconds),dataPointsToBacktrack<times.length&&(deltaValue=this.calculateDeltaValue(resultField,dataPointsToBacktrack,deltaFormat,currentValue),deltaBacktrack=dataPointsToBacktrack))}}deltaValue||0===deltaValue||(deltaValue=this.calculateDeltaValue(resultField,1,deltaFormat,currentValue),deltaBacktrack=1),formatPattern&&!isNaN(deltaValue)&&(formattedDeltaValue=numeral(deltaValue).format(formatPattern),this.model.results.set("formattedDeltaValue",formattedDeltaValue)),this.model.results.set("deltaValue",deltaValue),this.model.results.set("deltaBacktrack",deltaBacktrack)},calculateDeltaValue:function(resultField,dataPointsToBacktrack,deltaFormat,currentValue){var previousValue=this.getFieldValue(resultField,dataPointsToBacktrack);return deltaFormat&&"percent"===deltaFormat.toLowerCase()?"0"===previousValue?"0"===currentValue?0:currentValue>previousValue?"percentageIncrease":"percentageDecrease":(currentValue-previousValue)/previousValue*100:currentValue-previousValue},onAddedToDocument:function(){VisualizationBase.prototype.onAddedToDocument.apply(this,arguments),this.validateReflow(!0)},reflow:function(){this.updateContainerDimensions(),this.updateBackgroundDimensions(),this.invokeOnChildren("validateReflow",!0)},updateContainerDimensions:function(){var scaleRatio,$svgContainer=this.getSvgContainer();this.model.config.get("exportMode")?(this.svgWidth=this.options.width,this.svgHeight=this.options.height):(this.svgHeight=this.$el.height(),this.svgWidth=this.$el.width()),1==this.$el.find(this.$inlineMessage).length&&(this.svgHeight=this.svgHeight-this.$inlineMessage.height()),generalUtil.valuesAreNumericAndFinite([this.svgHeight,this.svgWidth])&&($svgContainer.height(this.svgHeight).width(this.svgWidth),scaleRatio=this.svgHeight/this.originalHeight,generalUtil.valuesAreNumericAndFinite([scaleRatio])&&0!==scaleRatio||(scaleRatio=1),this.model.presentation.set({svgWidth:this.svgWidth,svgHeight:this.svgHeight,scaleRatio:scaleRatio}))},getResultField:function(field){var resultFieldValue=this.getFieldValue(this.determineResultFieldName(field));return resultFieldValue?resultFieldValue:_("N/A").t()},getFieldNames:function(){var fields=this.model.searchData.get("fields");return fields&&0!==fields.length?_.isObject(fields[0])?_(fields).pluck("name"):$.extend([],fields):[]},getFieldValue:function(field,idx){var column=this.getFieldValues(field);return idx||(idx=0),column&&column.length?this.isTimeSeries()?column[column.length-idx-1]:column[idx]:""},getFieldValues:function(fieldName){var fields=this.getFieldNames(),columns=this.model.searchData.get("columns")||[],countIdx=_(fields).indexOf(fieldName);return columns[countIdx]},determineResultFieldName:function(configuredField){var fields=this.getFieldNames();return configuredField&&_(fields).contains(configuredField)?configuredField:_(fields).find(function(f){return"_raw"===f||"_"!==f[0]})},isTimeSeries:function(){var fields=this.getFieldNames();return _(fields).some(function(f){return"_time"===f})},getSvgContainer:function(){return this.$(".svg-container")},getBackgroundMode:function(){return this.model.config.get("display.visualizations.singlevalue.colorMode")||"none"},updateBackgroundDimensions:function(){var background;this.hasBackground()&&(background=this.getSvgContainer().find(".block-background"),background.length>0&&(background.attr("width",this.svgWidth),background.attr("height",this.svgHeight)))},drawSeverityBackground:function($svgContainer){this.hasBackground()&&$svgContainer.append(svgUtil.createElement("rect").attr({x:0,y:0,width:this.svgWidth,height:this.svgHeight,"class":"block-background",fill:this.getBackgroundColor()}))},drawSvgContainer:function(){var $svgContainer=this.getSvgContainer();return $svgContainer.length>0&&$svgContainer.remove(),$svgContainer=svgUtil.createElement("svg").width(this.svgWidth).height(this.svgHeight).attr("class","svg-container").css("position","absolute").css("top","0").css("left","0"),$svgContainer.appendTo(this.el),$svgContainer},drawSparkline:function($svgContainer){this.children.sparkline&&(this.children.sparkline.detach(),this.children.sparkline.remove()),this.hasSparkline?(this.model.results.set({sparklineData:this.model.results.get("sparkline").slice(0)}),this.model.presentation.set({sparklineOpacity:1}),this.children.sparkline=new Sparkline({model:{presentation:this.model.presentation,results:this.model.results,state:this.model.config}}),this.children.sparkline.render().appendTo($svgContainer)):this.model.results.unset("sparklineData")},setDisplayMode:function(displayMode){this.model.presentation.set("displayMode",displayMode)},drawMainBody:function($svgContainer){var mainBodyPadding,deltaFontSize,deltaScale,singleValueFont,sideLabelFont,hasUnderLabel=this.model.config.get("display.visualizations.singlevalue.underLabel"),displayMode=this.model.presentation.get("displayMode"),displayModeSimpleMultiplier=.5;this.hasSparkline&&hasUnderLabel?(singleValueFont=50,sideLabelFont=28,mainBodyPadding=50,deltaFontSize=20,deltaScale=.85):(singleValueFont=66,sideLabelFont=37,deltaFontSize=26,deltaScale=1.1,mainBodyPadding=this.hasSparkline||hasUnderLabel?60:70),"simple"===displayMode&&(singleValueFont*=displayModeSimpleMultiplier,sideLabelFont*=displayModeSimpleMultiplier,deltaFontSize*=displayModeSimpleMultiplier,deltaScale*=displayModeSimpleMultiplier,mainBodyPadding-=6),this.children.mainBody&&(this.children.mainBody.detach(),this.children.mainBody.remove()),this.model.presentation.set({singleValueFontSize:singleValueFont,sideLabelFontSize:sideLabelFont,mainBodyPadding:mainBodyPadding,deltaFontSize:deltaFontSize,deltaScale:deltaScale}),this.children.mainBody=new MainBodyView({model:{application:this.model.application,state:this.model.config,results:this.model.results,presentation:this.model.presentation}}),this.listenTo(this.children.mainBody,"singleDrilldownClicked",function(params){this.handleSingleDrilldownClicked(params)}),this.listenTo(this.children.mainBody,"anchorTagClicked",function(e){this.handleAnchorTagClicked(e)}),this.children.mainBody.render().appendTo($svgContainer)},handleSingleDrilldownClicked:function(params){this.trigger(params.specificEventNames,params.drilldownInfo)},handleAnchorTagClicked:function(e){var href=$(e.currentTarget).attr("href");href&&route.redirectTo(href,drilldownUtil.shouldDrilldownInNewTab(e))},drawUnderLabel:function($svgContainer){var underLabelY,underLabelColor=this.hasBackground()?this.BLOCK_DEFAULT_FONT_COLOR:this.UNDERLABEL_COLOR,underLabelOpacity=this.hasBackground()?.8:1;underLabelY=this.hasSparkline?72:85,this.children.underLabel&&(this.children.underLabel.detach(),this.children.underLabel.remove()),this.model.presentation.set({underLabelY:underLabelY,underLabelColor:underLabelColor,underLabelOpacity:underLabelOpacity}),this.children.underLabel=new UnderLabelView({model:{state:this.model.config,results:this.model.results,presentation:this.model.presentation,application:this.model.application}}),this.listenTo(this.children.underLabel,"singleDrilldownClicked",function(params){this.handleSingleDrilldownClicked(params)}),this.listenTo(this.children.underLabel,"anchorTagClicked",function(e){this.handleAnchorTagClicked(e)}),this.children.underLabel.render().appendTo($svgContainer)},drawComponents:function(){var $svgContainer=this.drawSvgContainer();this.hasSparkline=this.model.results.get("sparkline")&&splunkUtil.normalizeBoolean(this.model.config.get("display.visualizations.singlevalue.showSparkline"))!==!1,this.model.presentation.set("hasSparkline",this.hasSparkline),this.drawSeverityBackground($svgContainer),this.drawMainBody($svgContainer),this.model.config.get("display.visualizations.singlevalue.underLabel")&&this.drawUnderLabel($svgContainer),this.drawSparkline($svgContainer)},renderMaxResultCountMessage:function(resultCount){var message=splunkUtil.sprintf(_("These results may be truncated. This visualization is configured to display a maximum of %s results per series, and that limit has been reached.").t(),resultCount);this.$inlineMessage.html(_(this.inlineMessageTemplate).template({message:message,level:"warning"}))},inlineMessageTemplate:'\t                <div class="alert alert-inline alert-<%= level %> alert-inline"> \t                    <i class="icon-alert"></i> \t                    <%- message %> \t                </div> \t            ',updateView:function(){this.updateResultState(),this.$el.removeClass(this._dynamicClasses||""),this._dynamicClasses=[this.model.config.get("display.visualizations.singlevalue.additionalClass"),this.getFieldValue(this.model.config.get("display.visualizations.singlevalue.classField"))].join(" "),this.$el.addClass(this._dynamicClasses),this.drawComponents(),this.$inlineMessage.remove(),this.model.searchDataParams&&(this.MAX_RESULT_COUNT=this.model.searchDataParams.get("count")),this.model.results.get("sparkline")&&this.model.results.get("sparkline").length>=this.MAX_RESULT_COUNT&&(this.renderMaxResultCountMessage(this.MAX_RESULT_COUNT),this.$inlineMessage.insertAfter(this.$(".svg-container"))),this.isAddedToDocument()&&this.reflow()}},"dark"===themeUtils.getCurrentTheme()?THEMES.dark:THEMES.enterprise))}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"util/theme_utils":function(module,exports,__webpack_require__){"use strict";function getCurrentTheme(){return window.__splunk_page_theme__||defaultTheme}function getXmlEditorTheme(){var pageTheme=getCurrentTheme();return"dark"===pageTheme?"ace/theme/xml-dark":"ace/theme/chrome"}function getSearchEditorTheme(){var pageTheme=getCurrentTheme();return"dark"===pageTheme?"dark":"light"}__webpack_require__(1),Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCurrentTheme=getCurrentTheme,exports.getXmlEditorTheme=getXmlEditorTheme,exports.getSearchEditorTheme=getSearchEditorTheme;var defaultTheme="light"},"views/shared/singlevalue/MainBody":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),module,__webpack_require__("views/Base"),__webpack_require__("views/shared/singlevalue/Labels"),__webpack_require__("views/shared/singlevalue/Delta"),__webpack_require__("models/Base"),__webpack_require__("shim/splunk.util"),__webpack_require__("util/svg"),__webpack_require__("util/general_utils"),__webpack_require__("util/math_utils")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,module,BaseView,LabelsView,DeltaView,BaseModel,splunkUtil,svgUtil,generalUtil,mathUtil){return BaseView.extend({moduleId:module.id,className:"single-value-main-body",el:function(){return svgUtil.createElement("g").attr("class","single-value-main-body")},DELTA_PADDING:10,initialize:function(options){BaseView.prototype.initialize.apply(this,arguments),this.model.presentation.set("deltaPadding",this.DELTA_PADDING)},reflow:function(){var mainLabelsRightX,deltaWidth,labelWidth,maxDeltaWidth,maxLabelsWidth,$rightmostLabel,rightLabelWidth,rightLabelLeftX,edgePadding=this.model.presentation.get("edgePadding"),svgWidth=this.model.presentation.get("svgWidth")-2*edgePadding,scaleRatio=this.model.presentation.get("scaleRatio"),mainBodyPadding=this.model.presentation.get("mainBodyPadding"),scaledMainBodyPadding=mainBodyPadding*scaleRatio;generalUtil.valuesAreNumericAndFinite([scaledMainBodyPadding])&&this.$el.attr("transform","translate(0,"+scaledMainBodyPadding+")"),this.displayDelta()?(svgWidth-=this.DELTA_PADDING,this.maxLabelProportion||(labelWidth=this.children.labels.getMainLabelsWidth(),deltaWidth=this.children.delta.el.getBBox().width,this.maxLabelProportion=mathUtil.roundToDecimal(labelWidth/(labelWidth+deltaWidth),-2)),maxLabelsWidth=mathUtil.roundToDecimal(svgWidth*this.maxLabelProportion,-2),maxDeltaWidth=svgWidth-maxLabelsWidth,this.model.presentation.set("maxLabelsWidth",maxLabelsWidth),this.model.presentation.set("maxDeltaWidth",maxDeltaWidth)):(this.model.presentation.set("maxLabelsWidth",svgWidth),this.model.presentation.set("maxDeltaWidth",0)),this.children.labels.validateReflow(!0),this.displayDelta()?(this.children.delta.validateReflow(!0),deltaWidth=this.children.delta.el.getBoundingClientRect().width,this.model.presentation.set("deltaWidth",deltaWidth)):this.model.presentation.set("deltaWidth",0),this.children.labels.positionLabels(),this.displayDelta()&&($rightmostLabel=this.hasAfterLabel?this.children.labels.children.afterLabelView:this.children.labels.children.singleResultView,rightLabelLeftX=parseFloat($rightmostLabel.$("text").attr("x")),rightLabelWidth=$rightmostLabel.getWidth(),mainLabelsRightX=rightLabelLeftX+rightLabelWidth,this.model.presentation.set("deltaLeft",mainLabelsRightX),this.children.delta.positionAndScaleElements())},drawLabels:function(){this.children.labels&&this.children.labels.remove();var unit=this.model.state.get("display.visualizations.singlevalue.unit");if("undefined"==typeof unit||""===unit)this.hasUnit=!1,this.hasAfterLabel=!!this.model.state.get("display.visualizations.singlevalue.afterLabel"),this.hasBeforeLabel=!!this.model.state.get("display.visualizations.singlevalue.beforeLabel");else{this.hasUnit=!0;var unitPosition=this.model.state.get("display.visualizations.singlevalue.unitPosition");"before"===unitPosition?(this.unitPosition="before",this.hasBeforeLabel=!1,this.hasAfterLabel=!1):(this.unitPosition="after",this.hasBeforeLabel=!1,this.hasAfterLabel=!1)}this.children.labels=new LabelsView({model:{application:this.model.application,state:this.model.state,results:this.model.results,presentation:this.model.presentation},unit:unit,unitPosition:this.unitPosition,hasUnit:this.hasUnit,hasBeforeLabel:this.hasBeforeLabel,hasAfterLabel:this.hasAfterLabel}),this.listenTo(this.children.labels,"singleDrilldownClicked",function(params){this.trigger("singleDrilldownClicked",params)}),this.listenTo(this.children.labels,"anchorTagClicked",function(e){this.trigger("anchorTagClicked",e)}),this.children.labels.render().appendTo(this.$el)},drawDelta:function(){this.children.delta&&(this.children.delta.detach(),this.children.delta.remove()),this.displayDelta()&&(this.children.delta=new DeltaView({model:{state:this.model.state,presentation:this.model.presentation,results:this.model.results}}),this.children.delta.render().appendTo(this.$el))},displayDelta:function(){var showDeltaValue=splunkUtil.normalizeBoolean(this.model.state.get("display.visualizations.singlevalue.showTrendIndicator")),deltaValue=this.model.results.get("deltaValue");return showDeltaValue!==!1&&(deltaValue||0===deltaValue)},drawComponents:function(){this.drawLabels(),this.drawDelta()},render:function(){return this.drawComponents(),this}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"views/shared/singlevalue/Labels":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),module,__webpack_require__("views/Base"),__webpack_require__("views/shared/singlevalue/Label"),__webpack_require__("models/Base"),__webpack_require__("shim/splunk.util"),__webpack_require__("util/svg"),__webpack_require__("util/math_utils")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,module,BaseView,LabelView,BaseModel,splunkUtil,svgUtil,mathUtil){return BaseView.extend({moduleId:module.id,className:"single-value-labels",el:function(){return svgUtil.createElement("g").attr("class","single-value-labels")},LABEL_SIDE_PADDING:5,initialize:function(options){BaseView.prototype.initialize.apply(this,arguments),this.activate(),this.unit=options.unit,this.unitPosition=options.unitPosition,this.hasUnit=options.hasUnit,this.hasAfterLabel=options.hasAfterLabel,this.hasBeforeLabel=options.hasBeforeLabel,this.originalSingleValueFontSize=this.model.presentation.get("singleValueFontSize"),this.originalSideLabelFontSize=this.model.presentation.get("sideLabelFontSize"),this.updateContainerDimensions()},reflow:function(){this.updateContainerDimensions(),this.scaleLabels()},updateContainerDimensions:function(){this.scaleRatio=this.model.presentation.get("scaleRatio"),this.singleValueFontSize=this.originalSingleValueFontSize*this.scaleRatio,this.labelFontSize=this.originalSideLabelFontSize*this.scaleRatio},constructMainLabelData:function(){var labelData,fontColor=this.model.presentation.get("fontColor"),beforeLabelConfigName="display.visualizations.singlevalue.beforeLabel",afterLabelConfigName="display.visualizations.singlevalue.afterLabel";return labelData={singleResultData:{labelFontSize:this.originalSingleValueFontSize,labelFontColor:fontColor,labelGroupClass:"single-result-group",labelClass:"single-result",linkField:"result",configName:"display.visualizations.singlevalue.singleResult",useResultField:!0,fontWeight:"bold",unit:this.unit,unitPosition:this.unitPosition,hasUnit:this.hasUnit,exportMode:!!this.model.state.get("exportMode")}},this.hasBeforeLabel&&(labelData.beforeLabelData={labelFontSize:this.originalSideLabelFontSize,labelFontColor:fontColor,labelGroupClass:"before-label-group",labelClass:"before-label",linkField:"beforelabel",configName:beforeLabelConfigName,useResultField:!1,fontWeight:"normal"}),this.hasAfterLabel&&(labelData.afterLabelData={labelFontSize:this.originalSideLabelFontSize,labelFontColor:fontColor,labelGroupClass:"after-label-group",labelClass:"after-label",linkField:"afterlabel",configName:afterLabelConfigName,useResultField:!1,fontWeight:"normal"}),labelData},getMainLabelsWidth:function(){var mainLabelsWidth=0;return this.hasBeforeLabel&&(mainLabelsWidth+=this.children.beforeLabelView.getWidth(),mainLabelsWidth+=this.LABEL_SIDE_PADDING),this.hasAfterLabel&&(mainLabelsWidth+=this.children.afterLabelView.getWidth(),mainLabelsWidth+=this.LABEL_SIDE_PADDING),mainLabelsWidth+=this.children.singleResultView.getWidth()},positionLabels:function(){var beforeLabel,afterLabel,beforeLabelWidth,shiftWidth=0,singleValue=this.children.singleResultView.getLabelElement(),beforeLabelX=shiftWidth,singleValueX=shiftWidth,afterLabelX=0,singleValueWidth=this.children.singleResultView.getWidth(),mainLabelsWidth=this.getMainLabelsWidth(),deltaWidth=this.model.presentation.get("deltaWidth")||0,svgWidth=this.model.presentation.get("svgWidth");deltaWidth>0&&(deltaWidth+=this.model.presentation.get("deltaPadding")),shiftWidth=mathUtil.roundToDecimal(svgWidth/2-(mainLabelsWidth+deltaWidth)/2,-2),this.hasBeforeLabel?(beforeLabelWidth=this.children.beforeLabelView.getWidth(),beforeLabel=this.children.beforeLabelView.getLabelElement(),beforeLabelX=shiftWidth,singleValueX=beforeLabelWidth+beforeLabelX+this.LABEL_SIDE_PADDING,beforeLabel.attr("x",beforeLabelX)):singleValueX=shiftWidth,singleValue.attr("x",singleValueX),this.hasAfterLabel&&(afterLabel=this.children.afterLabelView.getLabelElement(),afterLabelX=singleValueX+singleValueWidth+this.LABEL_SIDE_PADDING,afterLabel.attr("x",afterLabelX))},scaleLabels:function(){var beforeLabel,afterLabel,mainLabelsWidth,maxLabelRatio,singleValue=this.children.singleResultView.getLabelElement(),maxLabelWidth=this.model.presentation.get("maxLabelsWidth");this.defaultMainLabelsWidth||(this.defaultMainLabelsWidth=this.getMainLabelsWidth()),singleValue.css("font-size",this.singleValueFontSize),(this.model.state.get("exportMode")||0!==this.children.singleResultView.getWidth())&&(this.hasBeforeLabel&&(beforeLabel=this.children.beforeLabelView.getLabelElement(),beforeLabel.css("font-size",this.labelFontSize)),this.hasAfterLabel&&(afterLabel=this.children.afterLabelView.getLabelElement(),afterLabel.css("font-size",this.labelFontSize)),mainLabelsWidth=this.getMainLabelsWidth(),mainLabelsWidth>maxLabelWidth&&"simple"!==this.model.presentation.get("displayMode")&&(maxLabelRatio=mathUtil.roundToDecimal(maxLabelWidth/this.defaultMainLabelsWidth,-4),this.singleValueFontSize=mathUtil.roundToDecimal(this.originalSingleValueFontSize*maxLabelRatio,-4),this.labelFontSize=mathUtil.roundToDecimal(this.originalSideLabelFontSize*maxLabelRatio,-4),singleValue.css("font-size",this.singleValueFontSize),this.hasBeforeLabel&&(beforeLabel=this.children.beforeLabelView.getLabelElement(),beforeLabel.css("font-size",this.labelFontSize)),this.hasAfterLabel&&(afterLabel=this.children.afterLabelView.getLabelElement(),afterLabel.css("font-size",this.labelFontSize))))},createLabel:function(mainGroup,mainLabelData,modelOptions,viewName,dataName){this.children[viewName]&&(this.children[viewName].detach(),this.children[viewName].remove()),this.children[viewName]=new LabelView(_.extend(modelOptions,mainLabelData[dataName])),this.children[viewName].render().appendTo(mainGroup),this.listenTo(this.children[viewName],"singleDrilldownClicked",function(params){this.trigger("singleDrilldownClicked",params)}),this.listenTo(this.children[viewName],"anchorTagClicked",function(e){
this.trigger("anchorTagClicked",e)})},render:function(){var mainGroup=this.$el.find(".main-label-group"),mainLabelData=this.constructMainLabelData(),modelOptions={model:{state:this.model.state,results:this.model.results,presentation:this.model.presentation,application:this.model.application}};return mainGroup.length>0&&mainGroup.remove(),mainGroup=svgUtil.createElement("g").attr("class","main-label-group"),this.$el.append(mainGroup),this.hasBeforeLabel&&this.createLabel(mainGroup,mainLabelData,modelOptions,"beforeLabelView","beforeLabelData"),this.createLabel(mainGroup,mainLabelData,modelOptions,"singleResultView","singleResultData"),this.hasAfterLabel&&this.createLabel(mainGroup,mainLabelData,modelOptions,"afterLabelView","afterLabelData"),this}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"views/shared/singlevalue/Label":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),module,__webpack_require__("views/Base"),__webpack_require__("models/Base"),__webpack_require__("shim/splunk.util"),__webpack_require__("util/svg"),__webpack_require__("util/general_utils"),__webpack_require__("uri/route"),__webpack_require__("util/numeral")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,module,BaseView,BaseModel,splunkUtil,svgUtil,generalUtil,route,numeral){var getStringRepresentation=function(label,formatted){if(_.isFunction(label))try{label=label(formatted)}catch(e){return""}return label};return BaseView.extend({moduleId:module.id,className:"single-value-label",el:function(){return svgUtil.createElement("g").attr({"class":"single-value-label","data-name":this.options.configName})},initialize:function(options){if(BaseView.prototype.initialize.apply(this,arguments),this.activate(),this.LABEL_FONT_SIZE=this.options.labelFontSize,this.labelFontColor=this.options.labelFontColor,this.labelGroupClass=this.options.labelGroupClass,this.labelClass=this.options.labelClass,this.linkField=this.options.linkField,this.resultFieldValue=this.model.results.get("resultFieldValue"),this.configName=this.options.configName,this.unit=this.options.unit,this.unitPosition=this.options.unitPosition,this.hasUnit=this.options.hasUnit,this.isNumericLabelValue=!1,this.options.useResultField)if(isNaN(this.resultFieldValue))this.labelValue=this.resultFieldValue;else{var formatPattern=this.model.presentation.get("formatPattern");this.labelValue=numeral(this.resultFieldValue).format(formatPattern),this.isNumericLabelValue=!0}else this.labelValue=getStringRepresentation(this.model.state.get(this.configName)||"",this.resultFieldValue);this.fontWeight=this.options.fontWeight,this.labelOpacity=this.options.labelOpacity,this.exportMode=this.options.exportMode},events:{"click a.single-drilldown":function(e){e.preventDefault();var target=$(e.currentTarget),resModel=this.model.results.get("searchResultsColumn"),names=resModel.get("fields");_.isObject(names[0])&&(names=_(names).pluck("name"));var rowContext=_.object(_(names).map(function(f){return"row."+f}),_(resModel.get("columns")).map(function(col){return _(col).last()})),drilldownInfo={name:target.data("field"),value:target.data("value"),rowContext:rowContext,originalEvent:e,type:"cell"};if(this.model.results.has("sparklineData")){var timeFieldIndex=_(names).indexOf("_time"),spanFieldIndex=_(names).indexOf("_span"),columns=resModel.get("columns"),lastTimestamp=splunkUtil.getEpochTimeFromISO(_(columns[timeFieldIndex]).last()),lastTimespan=parseFloat(_(columns[spanFieldIndex]).last());drilldownInfo.name2=drilldownInfo.name,drilldownInfo.value2=drilldownInfo.value,drilldownInfo.name="_time",drilldownInfo.value=lastTimestamp,drilldownInfo._span=lastTimespan,drilldownInfo.rowContext["row._time"]=lastTimestamp,drilldownInfo.rowContext["row._span"]=lastTimespan}var specificEventNames=_(target.children("text").attr("class").split(" ")).map(function(cls){return"click:"+cls}).join(" ");this.trigger("singleDrilldownClicked",{specificEventNames:"click drilldown "+specificEventNames,drilldownInfo:drilldownInfo})},"click a.link-drilldown":function(e){e.preventDefault(),this.trigger("anchorTagClicked",e)}},constructLabelData:function(){var labelData;this.model.presentation.get("severityColor");return labelData={name:this.labelClass,linkField:this.linkField,value:this.labelValue,fontSize:this.LABEL_FONT_SIZE+"px",fontWeight:this.fontWeight,fontColor:this.labelFontColor,opacity:this.labelOpacity||1}},drawLabel:function(container,labelData){var labelGroup,labelText,labelAnchor;labelGroup=svgUtil.createElement("g").attr("class","svg-label"),labelText=svgUtil.createElement("text").attr({x:labelData.x,y:labelData.y,"class":labelData.name}).css({"letter-spacing":this.isNumericLabelValue?"-0.02em":"normal","font-size":labelData.fontSize,"font-weight":labelData.fontWeight,fill:labelData.fontColor,opacity:labelData.opacity});var labelValue=""+labelData.value;if(this.hasUnit&&"before"===this.unitPosition)if(/^\-\d/.test(labelValue)&&(labelText.append(document.createTextNode("-")),labelValue=labelValue.substring(1)),this.exportMode)labelValue=""+this.unit+labelValue;else{var beforeSpan=svgUtil.createElement("tspan").attr({"class":labelData.name+"-unit"}).css({"letter-spacing":"normal"}).text(""+this.unit);labelText.append(beforeSpan)}if(labelText.append(document.createTextNode(labelValue)),this.hasUnit&&"after"===this.unitPosition)if(this.exportMode)labelText.append(document.createTextNode(" "+this.unit));else{var afterSpan=svgUtil.createElement("tspan").attr({"class":labelData.name+"-unit"}).css({"letter-spacing":"normal"}).text(" "+this.unit);labelText.append(afterSpan)}labelData.link?(labelAnchor=svgUtil.createElement("a").attr({href:labelData.link.attr("href"),"class":labelData.link.attr("class")}).css({"text-decoration":"none"}),labelAnchor.data("value",labelData.value),labelAnchor.data("field",labelData.linkField),labelAnchor.append(labelText),labelGroup.append(labelAnchor),labelText.hover(function(e){labelText.css({"text-decoration":"mouseenter"===e.type?"underline":"none"})})):labelGroup.append(labelText),container.append(labelGroup),this.labelElement=this.getLabelElement()},getWidth:function(){return this.getBBox(this.labelElement).width},getLeftX:function($label){return parseInt($label.attr("x"),10)},getBBox:function($label){var bbox;try{bbox=$label[0].getBBox()}catch(e){bbox={x:0,y:0,width:0,height:0}}return bbox},getRightX:function($label){return this.getLeftX($label)+this.getWidth($label)},getClientRect:function($label){return $label[0].getBoundingClientRect()},getLabelElement:function(){var label=this.$("."+this.labelClass);if(label.length>0)return label},wrapLinks:function(field,value){if(this.model.application){var linkFields=this.model.state.get("display.visualizations.singlevalue.linkFields");linkFields=linkFields?$.trim(linkFields).split(/\s*,\s*/):[];var link,linkView=this.model.state.get("display.visualizations.singlevalue.linkView"),linkSearch=this.model.state.get("display.visualizations.singlevalue.linkSearch"),drilldown=this.model.state.get("display.visualizations.singlevalue.drilldown")||"none",app=this.model.application.toJSON();if("search"!==linkView&&linkFields.length||linkSearch){var url;if(linkView){var params=linkSearch?{q:linkSearch}:void 0;url="/"===linkView.charAt(0)?splunkUtil.make_full_url(linkView,params):route.page(app.root,app.locale,app.app,linkView,{data:params})}else url=route.search(app.root,app.locale,app.app,{data:{q:linkSearch}});link=$('<a class="link-drilldown" />').attr("href",url)}else"none"!==drilldown&&(link=$('<a class="single-drilldown" href="#"></a>'),_(linkFields).contains("result")||linkFields.push("result"));return link?(link.data({field:field,value:value}),{linkFields:linkFields,link:link}):void 0}},render:function(){var labelGroup,labelData=this.constructLabelData(),resultFieldValue=this.model.results.get("resultFieldValue"),linkArray=this.wrapLinks(this.model.results.get("resultField"),resultFieldValue);return linkArray&&_.each(linkArray.linkFields,function(linkField){this.linkField===linkField&&(labelData.link=linkArray.link)},this),labelGroup=this.$el.find("."+this.labelGroupClass),labelGroup.length>0&&labelGroup.remove(),labelGroup=svgUtil.createElement("g").attr("class",this.labelGroupClass),this.$el.append(labelGroup),this.drawLabel(labelGroup,labelData),this}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"util/numeral":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("stubs/i18n"),__webpack_require__("shim/numeral")],__WEBPACK_AMD_DEFINE_RESULT__=function(i18n,numeral){var initFn=i18n.numeral_install,localeMap={de_DE:"de",en_DEBUG:"en-debug",en_GB:"en-gb",en_US:"en-us",it_IT:"it",ko_KR:"ko",zh_CN:"chs",zh_TW:"chs-traditional"};return"function"==typeof initFn&&(initFn(numeral),numeral.language(localeMap[i18n.locale_name()])),numeral}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"shim/numeral":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(916)],__WEBPACK_AMD_DEFINE_RESULT__=function(numeral){return numeral}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"views/shared/singlevalue/Sparkline":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),module,__webpack_require__("views/Base"),__webpack_require__("shim/splunk.util"),__webpack_require__("util/svg"),__webpack_require__("util/general_utils"),__webpack_require__("util/math_utils")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,module,BaseView,splunkUtil,svgUtil,generalUtil,mathUtil){return BaseView.extend({moduleId:module.id,className:"single-value-sparkline",el:function(){return svgUtil.createElement("g").attr("class","single-value-sparkline")},SPARKLINE_WIDTH:150,SPARKLINE_HEIGHT:14,SPARKLINE_Y:77,DEFAULT_SPARKLINE_COLOR:"#000000",initialize:function(options){BaseView.prototype.initialize.apply(this,arguments),this.sparklineColor=this.model.presentation.get("sparklineColor"),this.activate()},drawSparkline:function(){var opacity=this.model.presentation.get("sparklineOpacity")||1,counter=1,rawData=this.model.results.get("sparklineData"),deltaBacktrack=this.model.results.get("deltaBacktrack");if(this.$el.empty(),rawData&&!(rawData.length<2)){var points=[],minX=1/0,maxX=-(1/0),minY=1/0,maxY=-(1/0);_.each(rawData,function(d){var x=counter++,y=parseFloat(d)||0;minX=Math.min(x,minX),maxX=Math.max(x,maxX),minY=Math.min(y,minY),maxY=Math.max(y,maxY),points.push({x:x,y:y})});var width=this.SPARKLINE_WIDTH,height=this.SPARKLINE_HEIGHT;if(_.each(points,function(d,i){d.x=width*((d.x-minX)/Math.max(maxX-minX,1)),d.y=height*(1-(d.y-minY)/Math.max(maxY-minY,1))}),deltaBacktrack>0&&this.displayDeltaRange()){var endIndex=points.length-1,startIndex=Math.max(endIndex-deltaBacktrack,0);svgUtil.createElement("path").attr("class","sparkline").attr("d",this.pointsToPath(points.slice(0,startIndex+1))).attr("fill","none").attr("stroke",this.sparklineColor).attr("opacity",.6*opacity).attr("stroke-width","1px").attr("stroke-linecap","round").attr("stroke-linejoin","round").appendTo(this.$el),svgUtil.createElement("path").attr("class","sparkline-delta").attr("d",this.pointsToPath(points.slice(startIndex,endIndex+1))).attr("fill","none").attr("stroke",this.sparklineColor).attr("opacity",opacity).attr("stroke-width","1.5px").attr("stroke-linecap","round").attr("stroke-linejoin","round").appendTo(this.$el);var startPoint=points[startIndex];svgUtil.createElement("circle").attr("class","sparkline-point").attr("cx",startPoint.x).attr("cy",startPoint.y).attr("r",2).attr("fill",this.sparklineColor).attr("stroke","none").attr("opacity",opacity).appendTo(this.$el)}else svgUtil.createElement("path").attr("class","sparkline").attr("d",this.pointsToPath(points)).attr("fill","none").attr("stroke",this.sparklineColor).attr("opacity",opacity).attr("stroke-width","1.5px").attr("stroke-linecap","round").attr("stroke-linejoin","round").appendTo(this.$el);var endPoint=points[points.length-1];svgUtil.createElement("circle").attr("class","sparkline-point").attr("cx",endPoint.x).attr("cy",endPoint.y).attr("r",2).attr("fill",this.sparklineColor).attr("stroke","none").attr("opacity",opacity).appendTo(this.$el)}},positionAndScaleSparkline:function(){var originalHeight,maxHeight,maxWidthRatio,maxShiftWidth,maxShiftHeight,shiftWidth=mathUtil.roundToDecimal((this.svgWidth/2-this.sparklineWidth/2)/this.scaleRatio,-2),shiftHeight=this.SPARKLINE_Y,edgePadding=this.model.presentation.get("edgePadding"),availableWidth=this.svgWidth-2*edgePadding;this.sparklineWidth<availableWidth?generalUtil.valuesAreNumericAndFinite([this.scaleRatio,shiftWidth,shiftHeight])&&this.$el.attr({transform:"scale("+this.scaleRatio+")translate("+shiftWidth+","+shiftHeight+")"}):(maxWidthRatio=mathUtil.roundToDecimal(availableWidth/this.SPARKLINE_WIDTH,-2),maxShiftWidth=mathUtil.roundToDecimal(edgePadding/maxWidthRatio,-2),originalHeight=mathUtil.roundToDecimal(this.svgHeight/this.scaleRatio,-2),maxHeight=originalHeight*maxWidthRatio,maxShiftHeight=mathUtil.roundToDecimal(shiftHeight+(this.svgHeight-maxHeight)/maxWidthRatio,-2),generalUtil.valuesAreNumericAndFinite([maxWidthRatio,maxShiftWidth,maxShiftHeight])&&this.$el.attr({transform:"scale("+maxWidthRatio+")translate("+maxShiftWidth+","+maxShiftHeight+")"}))},pointsToPath:function(points){for(var point,path="",i=0,l=points.length;i<l;i++)point=points[i],path+=0===i?"M":"L",path+=point.x+","+point.y;return path},displayDeltaRange:function(){var showDeltaValue=splunkUtil.normalizeBoolean(this.model.state.get("display.visualizations.singlevalue.showTrendIndicator")),deltaValue=this.model.results.get("deltaValue");return showDeltaValue!==!1&&null!=deltaValue},reflow:function(){this.updateContainerDimensions(),this.positionAndScaleSparkline()},updateContainerDimensions:function(){this.svgWidth=this.model.presentation.get("svgWidth"),this.svgHeight=this.model.presentation.get("svgHeight"),this.scaleRatio=this.model.presentation.get("scaleRatio"),this.sparklineWidth=this.SPARKLINE_WIDTH*this.scaleRatio},render:function(){return this.drawSparkline(),this}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"views/shared/singlevalue/Delta":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),module,__webpack_require__("views/Base"),__webpack_require__("util/svg"),__webpack_require__("util/general_utils"),__webpack_require__("util/math_utils")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,module,BaseView,svgUtil,generalUtil,mathUtil){return BaseView.extend({moduleId:module.id,className:"single-value-delta",el:function(){return svgUtil.createElement("g").attr("class","single-value-delta")},SVG_POINTS:{decrease:{polylinePoints:"20.5,3 20.5,20.5 3,20.5",linePoints:[20.2,20.9,3.4,4]},increase:{polylinePoints:"20.5,21 20.5,3.5 3,3.5",linePoints:[20.2,3.3,3.4,20.2]},noChange:{polylinePoints:"14.8,20.2 23.8,11.2 14.8,2.2",linePoints:[0,11.2,23,11.2]}},INDICATOR_WIDTH:22,initialize:function(options){BaseView.prototype.initialize.apply(this,arguments),this.updateContainerDimensions(),this.activate()},drawComponents:function(){var deltaFormat=this.model.state.get("display.visualizations.singlevalue.trendDisplayMode");this.deltaValue=this.model.results.get("deltaValue"),this.formattedDeltaValue=this.model.results.get("formattedDeltaValue"),this.deltaValue&&0!==this.deltaValue?"percentageDecrease"===this.deltaValue||this.deltaValue<0?(this.indicatorMode="decrease",this.indicatorClass="delta-down-indicator"):("percentageIncrease"===this.deltaValue||this.deltaValue>0)&&(this.indicatorMode="increase",this.indicatorClass="delta-up-indicator"):(this.indicatorMode="noChange",this.indicatorClass="delta-no-change-indicator"),this.indicatorColor=this.model.presentation.get("deltaColor"),isNaN(this.deltaValue)||this.deltaValue===1/0||this.deltaValue===-(1/0)?this.formattedDeltaValue="N/A":deltaFormat&&"percent"===deltaFormat.toLowerCase()&&(this.formattedDeltaValue+="%"),this.drawLabel(),this.drawIndicator()},drawIndicator:function(){var indicatorGroup=svgUtil.createElement("g").attr({"class":"delta-indicator "+this.indicatorClass}),points=this.SVG_POINTS[this.indicatorMode],polyline=svgUtil.createElement("polyline").attr({points:points.polylinePoints,fill:"none",stroke:this.indicatorColor,"stroke-width":"5px"}),line=svgUtil.createElement("line").attr({x1:points.linePoints[0],y1:points.linePoints[1],x2:points.linePoints[2],y2:points.linePoints[3],fill:this.indicatorColor,stroke:this.indicatorColor,"stroke-width":"5px"});indicatorGroup.append(polyline),indicatorGroup.append(line),this.$el.append(indicatorGroup)},drawLabel:function(){var value=svgUtil.createElement("text").attr({"class":"delta-label"}).text(this.formattedDeltaValue).css({"font-size":this.model.presentation.get("deltaFontSize"),fill:this.indicatorColor,fontWeight:"bold"});this.$el.append(value)},updateContainerDimensions:function(){this.scaleRatio=this.model.presentation.get("scaleRatio")},positionAndScaleElements:function(){var labelWidth,deltaWidth,indicatorTranslateX,deltaTranslateX,maxDeltaRatio,$label=this.$el.find(".delta-label"),$indicator=this.$el.find(".delta-indicator"),deltaScale=this.model.presentation.get("deltaScale"),indicatorWidth=this.INDICATOR_WIDTH*deltaScale,deltaLeft=this.model.presentation.get("deltaLeft")||0,indicatorTranslateY=-45,maxDeltaWidth=this.model.presentation.get("maxDeltaWidth");this.defaultDeltaWidth||(this.defaultDeltaWidth=this.getDeltaWidth()),this.defaultLabelWidth||(this.defaultLabelWidth=$label[0].getBBox().width),deltaTranslateX=(deltaLeft+10)/this.scaleRatio,labelWidth=this.defaultLabelWidth,indicatorTranslateX=mathUtil.roundToDecimal(labelWidth/2-indicatorWidth/2,-2),generalUtil.valuesAreNumericAndFinite([this.scaleRatio,indicatorTranslateX,indicatorTranslateY,deltaTranslateX])&&($indicator.attr({transform:"scale("+deltaScale+")translate("+indicatorTranslateX+","+indicatorTranslateY+")"}),this.$el.attr({transform:"scale("+this.scaleRatio+")translate("+deltaTranslateX+")"})),deltaWidth=this.getDeltaWidth(),deltaWidth>maxDeltaWidth&&(maxDeltaRatio=mathUtil.roundToDecimal(maxDeltaWidth/this.defaultDeltaWidth,-2),deltaTranslateX=(deltaLeft+10)/maxDeltaRatio,generalUtil.valuesAreNumericAndFinite([maxDeltaRatio,deltaTranslateX])&&this.$el.attr({transform:"scale("+maxDeltaRatio+")translate("+deltaTranslateX+")"}))},getDeltaWidth:function(){return this.el.getBoundingClientRect().width},reflow:function(){this.updateContainerDimensions(),this.positionAndScaleElements()},render:function(){return this.drawComponents(),this}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"views/shared/singlevalue/UnderLabel":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),module,__webpack_require__("views/Base"),__webpack_require__("views/shared/singlevalue/Label"),__webpack_require__("models/Base"),__webpack_require__("shim/splunk.util"),__webpack_require__("util/svg"),__webpack_require__("util/general_utils"),__webpack_require__("util/math_utils")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,module,BaseView,LabelView,BaseModel,splunkUtil,svgUtil,generalUtil,mathUtil){return BaseView.extend({moduleId:module.id,className:"single-value-under-label",initialize:function(options){BaseView.prototype.initialize.apply(this,arguments)},el:function(){return svgUtil.createElement("g").attr("class","single-value-under-label")},LABEL_FONT_SIZE:12,createUnderLabel:function(){this.children.underLabel&&(this.children.underLabel.detach(),this.children.underLabel.remove()),this.children.underLabel=new LabelView({model:{state:this.model.state,results:this.model.results,presentation:this.model.presentation,application:this.model.application},labelFontSize:this.LABEL_FONT_SIZE,labelFontColor:this.model.presentation.get("underLabelColor"),labelGroupClass:"under-label-group",labelClass:"under-label",linkField:"underlabel",configName:"display.visualizations.singlevalue.underLabel",useResultField:!1,labelOpacity:this.model.presentation.get("underLabelOpacity"),fontWeight:"normal"}),this.listenTo(this.children.underLabel,"singleDrilldownClicked",function(params){this.trigger("singleDrilldownClicked",params)}),this.listenTo(this.children.underLabel,"anchorTagClicked",function(e){this.trigger("anchorTagClicked",e)})},reflow:function(){this.updateContainerDimensions(),this.positionAndScaleUnderLabel()},updateContainerDimensions:function(){this.svgWidth=this.model.presentation.get("svgWidth"),this.svgHeight=this.model.presentation.get("svgHeight"),this.scaleRatio=this.model.presentation.get("scaleRatio"),this.UNDER_LABEL_WIDTH=this.children.underLabel.getWidth()},positionAndScaleUnderLabel:function(){if(this.UNDER_LABEL_WIDTH){var shiftWidth=mathUtil.roundToDecimal(this.svgWidth/2-this.UNDER_LABEL_WIDTH/2,-2),shiftHeight=this.model.presentation.get("underLabelY")*this.scaleRatio;generalUtil.valuesAreNumericAndFinite([shiftWidth,shiftHeight])&&this.$el.attr({transform:"translate("+shiftWidth+","+shiftHeight+")"})}},render:function(){return this.createUnderLabel(),this.children.underLabel.render().appendTo(this.$el),this}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"util/drilldown":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),__webpack_require__("models/services/search/IntentionsParser"),__webpack_require__("shim/splunk.util"),__webpack_require__("util/console")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,IntentionsParser,splunkUtil,console){var appendSplitInfo=function(field,value,clickInfo){if(clickInfo.splitContext){var splitInfo=clickInfo.splitContext;Object.keys(splitInfo).forEach(function(name){if(_.contains(field,name)){var fieldIndex=field.indexOf(name);void 0===value[fieldIndex]&&(value[fieldIndex]=splitInfo[name])}else field.unshift(name),value.unshift(splitInfo[name])})}},computeModifierKey=function(clickInfo){var event=clickInfo.originalEvent||clickInfo;return!(!event.ctrlKey&&!event.metaKey)},computeAltKey=function(clickInfo){var event=clickInfo.originalEvent||clickInfo;return!!event.altKey},convertRowDrilldownToIntentions=function(clickInfo,metadata){var value,rowContext=_(clickInfo.rowContext).omit("row._time"),field=_(rowContext).chain().keys().map(function(f){return f.replace("row.","")}).value(),isGroupbyField=function(fieldName){return metadata[fieldName]&&metadata[fieldName].hasOwnProperty("groupby_rank")},isSplitbyField=function(fieldName){return _.any(metadata,function(meta){return meta.splitby_field===fieldName})};return metadata&&_.any(metadata,function(meta,fieldName){return isGroupbyField(fieldName)})&&(field=_(field).filter(function(f){return isGroupbyField(f)||isSplitbyField(f)})),value=_(field).map(function(f){return rowContext["row."+f]}),appendSplitInfo(field,value,clickInfo),{action:"fieldvalue",field:field.map(function(f){return normalizeField(f,clickInfo,metadata)}),value:value}},convertCellDrilldownToIntentions=function(clickInfo,metadata){var field,value;return"_time"===clickInfo.name?(field=_.compact([clickInfo.name2]),value=_.compact([clickInfo.value2])):clickInfo.name&&clickInfo.name2?(field=[clickInfo.name,clickInfo.name2],value=[clickInfo.value,clickInfo.value2]):clickInfo.name?(field=[clickInfo.name],value=[clickInfo.value]):(field=[clickInfo.name2],value=[clickInfo.value2]),appendSplitInfo(field,value,clickInfo),{action:"fieldvalue",field:field.map(function(f){return normalizeField(f,clickInfo,metadata)}),value:value}},convertColumnDrilldownToIntentions=function(clickInfo,metadata){if(clickInfo.splitContext||clickInfo.splitDataSource){var field=[],value=[];return clickInfo.value2&&(field.push(clickInfo.name2),value.push(clickInfo.value2)),appendSplitInfo(field,value,clickInfo),_.isEmpty(field)?{action:"keyword",field:normalizeField(clickInfo.name2,clickInfo,metadata)}:{action:"fieldvalue",field:field.map(function(f){return normalizeField(f,clickInfo,metadata)}),value:value}}return{action:"keyword",field:clickInfo.name2}},convertAddTermDrilldownToIntentions=function(clickInfo,metadata){if(clickInfo.splitContext||clickInfo.splitDataSource){var field=[],value=[];return clickInfo.value2&&(field.push(clickInfo.name2),value.push(clickInfo.value2)),appendSplitInfo(field,value,clickInfo),_.isEmpty(field)?{action:"addterm",value:normalizeField(clickInfo.name2,clickInfo,metadata)}:{action:"fieldvalue",field:field.map(function(f){return normalizeField(f,clickInfo,metadata)}),value:value}}return{action:"addterm",value:clickInfo.name2}},convertGeovizDrilldownToIntentions=function(clickInfo){var latLonFields,latLonValues,params,DRILLDOWN_PROPERTIES={_geo_lat_field:"_geo_lat_field",_geo_lon_field:"_geo_long_field",_geo_bounds_south:"_geo_bounds_south",_geo_bounds_west:"_geo_bounds_west",_geo_bounds_north:"_geo_bounds_north",_geo_bounds_east:"_geo_bounds_east"};return _.all(DRILLDOWN_PROPERTIES,function(srcKey){return!!clickInfo.data[srcKey]})?(params=_(DRILLDOWN_PROPERTIES).chain().map(function(srcKey,prop){return[prop,clickInfo.data[srcKey]]}).object().value(),_.extend({action:"geoviz"},params)):(latLonFields=clickInfo.fields.slice(0,2),latLonValues=_(latLonFields).map(function(f){return clickInfo.data[f]}),appendSplitInfo(latLonFields,latLonValues,clickInfo),{action:"fieldvalue",field:latLonFields,value:latLonValues})},normalizeField=function(fieldName,clickInfo,metadata){if(clickInfo&&clickInfo.splitDataSource){var updatedFieldName=clickInfo.splitDataSource+": "+fieldName;return metadata&&metadata[updatedFieldName]?updatedFieldName:fieldName}return fieldName},Drilldown={};return Drilldown.applyDrilldownIntention=function(clickInfo,query,metadata,applicationModel,options){options||(options={});var search=options.newSearch?"*":query.search,newTab=Drilldown.shouldDrilldownInNewTab(clickInfo,options),intentionsParser=new IntentionsParser;"_time"===clickInfo.name&&intentionsParser.set({"dispatch.earliest_time":clickInfo.value},{silent:!0}),clickInfo._span&&intentionsParser.set({"dispatch.latest_time":JSON.stringify(Math.round(1e3*(parseFloat(clickInfo.value)+clickInfo._span))/1e3)},{silent:!0});var intentionParams={negate:options.hasOwnProperty("negate")?options.negate:computeAltKey(clickInfo),stripReportsSearch:!options.hasOwnProperty("stripReportsSearch")||options.stripReportsSearch};options.fields&&options.fields.length>0?_.extend(intentionParams,{action:"fieldvalue",field:options.fields,value:options.values}):"geoviz"===clickInfo.type?_.extend(intentionParams,convertGeovizDrilldownToIntentions(clickInfo)):"column"===clickInfo.type?_.extend(intentionParams,convertColumnDrilldownToIntentions(clickInfo,metadata)):"row"===clickInfo.type?_.extend(intentionParams,convertRowDrilldownToIntentions(clickInfo,metadata)):"addterm"===clickInfo.type?_.extend(intentionParams,convertAddTermDrilldownToIntentions(clickInfo,metadata)):_.extend(intentionParams,convertCellDrilldownToIntentions(clickInfo,metadata)),console.info("Applying drilldown intention",intentionParams);var dfd=$.Deferred();return intentionsParser.fetch({data:_.extend({q:search,fieldMetaData:JSON.stringify(metadata),app:applicationModel.get("app"),owner:applicationModel.get("owner"),parse_only:!0},intentionParams)}).done(function(){dfd.resolve({q:splunkUtil.stripLeadingSearchCommand(intentionsParser.get("fullSearch")),earliest:intentionsParser.get("dispatch.earliest_time")||query.earliest||0,latest:intentionsParser.get("dispatch.latest_time")||query.latest||""},newTab)}).fail(function(){dfd.reject.apply(dfd,arguments)}),dfd.promise()},Drilldown.shouldDrilldownInNewTab=function(clickInfo,options){options=options||{};var modifierKey=clickInfo.hasOwnProperty("modifierKey")?clickInfo.modifierKey:computeModifierKey(clickInfo);return options.hasOwnProperty("drilldownNewTab")?options.drilldownNewTab:modifierKey},Drilldown._convertRowDrilldownToIntentions=convertRowDrilldownToIntentions,Drilldown._convertCellDrilldownToIntentions=convertCellDrilldownToIntentions,Drilldown._convertColumnDrilldownToIntentions=convertColumnDrilldownToIntentions,Drilldown._convertAddTermDrilldownToIntentions=convertAddTermDrilldownToIntentions,Drilldown._convertGeovizDrilldownToIntentions=convertGeovizDrilldownToIntentions,Drilldown._normalizeField=normalizeField,Drilldown}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"models/services/search/IntentionsParser":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),__webpack_require__("require/backbone"),__webpack_require__("models/Base"),__webpack_require__("util/splunkd_utils"),__webpack_require__("shim/splunk.util")],__WEBPACK_AMD_DEFINE_RESULT__=function($,_,Backbone,Base,splunkDUtils,splunkUtils){var DELIMITER=":!:";return Base.extend({url:"search/intentionsparser",sync:function(method,model,options){if("read"!==method)throw new Error("Sync operation not supported: "+method);options=$.extend(!0,{},options),options.type="POST";var data=options.data;_.isArray(data.field)&&(data.field=data.field.join(DELIMITER),data.value=data.value.join(DELIMITER));var url=options.data&&options.data.action?model.url:"search/parser",syncOptions=splunkDUtils.prepareSyncOptions(options,url);return syncOptions.data&&syncOptions.data.q&&(syncOptions.data.q=splunkUtils.addLeadingSearchCommand(syncOptions.data.q,!0)),Base.prototype.sync.call(this,"read",model,syncOptions)},fullSearch:function(){var fullSearch=this.get("fullSearch");if(fullSearch)return splunkUtils.stripLeadingSearchCommand(fullSearch);var reportsSearch=this.get("reportsSearch")||"",eventsSearch=splunkUtils.stripLeadingSearchCommand(this.get("eventsSearch")||"");return eventsSearch=eventsSearch&&eventsSearch===this.get("eventsSearch")?"| "+eventsSearch:eventsSearch,reportsSearch=reportsSearch?" | "+reportsSearch:reportsSearch,eventsSearch+reportsSearch},isReportsSearch:function(){var reportsSearch=this.get("reportsSearch");return!!reportsSearch}})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"util/moment/relative":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("util/moment"),__webpack_require__("require/underscore")],__WEBPACK_AMD_DEFINE_RESULT__=function(moment,_){function parseRemainder(result,remainder){for(;remainder.length;){var match=remainder.match(/([+-]?\d+)([a-z]\w*)/);result.push(parseRelativeTimeExpressionPart(remainder)),remainder=remainder.substring(match[0].length)}}
function parseRelativeTimeExpressionPart(part){if("now"==part)return{now:!0};var match=part.match(/([+-]?\d+)([a-z]\w*)/);if(match){var amount=match[1],unit=match[2],momentUnit=unitMap()[unit];if(!momentUnit)throw new Error("Invalid unit "+JSON.stringify(unit)+" in relative time expression");return{amount:parseInt(amount,10),unit:momentUnit}}throw new Error("Invalid relative time expression: "+JSON.stringify(part))}function parseRelativeTimeExpression(expr,options){if(options||(options={}),null!=expr){if(expr=String(expr).trim(),/^-?\d+$/.test(expr)){var plainNumber=parseInt(expr,10);if(options.treatPlainNumberAs)return[{amount:plainNumber,unit:unitMap()[options.treatPlainNumberAs]}];if(options.allowAbsoluteValue!==!1)return[{absolute:parseInt(expr,10)}];throw new Error("Absolute time value "+JSON.stringify(expr)+"is not allowed in relative time expression")}var result=[],parts=expr.split("@",2);if(""!==parts[0]&&result.push(parseRelativeTimeExpressionPart(parts[0])),parts.length>1){var snap=parts[1].match(/^[a-z]\w*/);if(!snap)throw new Error("Invalid snap-to expression: "+JSON.stringify(parts[1]));snap=snap[0];var remainder=parts[1].substring(snap.length),weekday=snap.match(/w([0-6])/);if(weekday)result.push({snapTo:"week"},{amount:parseInt(weekday[1],10),unit:"day"});else{var snapUnit=unitMap()[snap];if(!snapUnit)throw new Error("Invalid snap-to unit "+JSON.stringify(snapUnit)+" in relative time expression");result.push({snapTo:snapUnit})}remainder.length&&parseRemainder(result,remainder)}return result}}function applyRelativeTimeExpressionPart(m,expr){if(null!=expr.absolute)return moment.unix(expr.absolute);if(expr.now===!0)return moment();if(null!=expr.amount)return moment(m).add(expr.amount,expr.unit);if(expr.snapTo)return moment(m).startOf(expr.snapTo);throw new Error("Invalid parsed time expression part: "+JSON.stringify(expr))}function applyRelativeTimeExpression(m,parsed){return _.inject(parsed,applyRelativeTimeExpressionPart,m)}function isRelativeTimeExpression(val,options){try{var parsed=parseRelativeTimeExpression(val,options);return parsed.length>0}catch(e){return!1}}var UNITS={second:"s,sec,secs,second,seconds",minute:"m,min,minute,minutes",hour:"h,hr,hrs,hour,hours",day:"d,day,days",week:"w,week,weeks",month:"mon,month,months",quarter:"q,qtr,qtrs,quarter,quarters",year:"y,yr,yrs,year,years"},unitMap=_.once(function(){var result={};return _(UNITS).each(function(aliases,unit){_(aliases.split(",")).each(function(alias){result[alias]=unit})}),result});return moment.fn.applyRelative=function(expr,options){return applyRelativeTimeExpression(this,parseRelativeTimeExpression(expr,options))},{parseRelativeTimeExpression:parseRelativeTimeExpression,applyRelativeTimeExpression:applyRelativeTimeExpression,applyRelativeTimeExpressionPart:applyRelativeTimeExpressionPart,isRelativeTimeExpression:isRelativeTimeExpression}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},916:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(){/*!
	 * numeral.js
	 * version : 1.5.3
	 * author : Adam Draper
	 * license : MIT
	 * http://adamwdraper.github.com/Numeral-js/
	 */
(function(){function Numeral(number){this._value=number}function toFixed(value,precision,roundingFunction,optionals){var optionalsRegExp,output,power=Math.pow(10,precision);return output=(roundingFunction(value*power)/power).toFixed(precision),optionals&&(optionalsRegExp=new RegExp("0{1,"+optionals+"}$"),output=output.replace(optionalsRegExp,"")),output}function formatNumeral(n,format,roundingFunction){var output;return output=format.indexOf("$")>-1?formatCurrency(n,format,roundingFunction):format.indexOf("%")>-1?formatPercentage(n,format,roundingFunction):format.indexOf(":")>-1?formatTime(n,format):formatNumber(n._value,format,roundingFunction)}function unformatNumeral(n,string){var thousandRegExp,millionRegExp,billionRegExp,trillionRegExp,power,stringOriginal=string,suffixes=["KB","MB","GB","TB","PB","EB","ZB","YB"],bytesMultiplier=!1;if(string.indexOf(":")>-1)n._value=unformatTime(string);else if(string===zeroFormat)n._value=0;else{for("."!==languages[currentLanguage].delimiters.decimal&&(string=string.replace(/\./g,"").replace(languages[currentLanguage].delimiters.decimal,".")),thousandRegExp=new RegExp("[^a-zA-Z]"+languages[currentLanguage].abbreviations.thousand+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$"),millionRegExp=new RegExp("[^a-zA-Z]"+languages[currentLanguage].abbreviations.million+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$"),billionRegExp=new RegExp("[^a-zA-Z]"+languages[currentLanguage].abbreviations.billion+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$"),trillionRegExp=new RegExp("[^a-zA-Z]"+languages[currentLanguage].abbreviations.trillion+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$"),power=0;power<=suffixes.length&&!(bytesMultiplier=string.indexOf(suffixes[power])>-1&&Math.pow(1024,power+1));power++);n._value=(bytesMultiplier?bytesMultiplier:1)*(stringOriginal.match(thousandRegExp)?Math.pow(10,3):1)*(stringOriginal.match(millionRegExp)?Math.pow(10,6):1)*(stringOriginal.match(billionRegExp)?Math.pow(10,9):1)*(stringOriginal.match(trillionRegExp)?Math.pow(10,12):1)*(string.indexOf("%")>-1?.01:1)*((string.split("-").length+Math.min(string.split("(").length-1,string.split(")").length-1))%2?1:-1)*Number(string.replace(/[^0-9\.]+/g,"")),n._value=bytesMultiplier?Math.ceil(n._value):n._value}return n._value}function formatCurrency(n,format,roundingFunction){var spliceIndex,output,symbolIndex=format.indexOf("$"),openParenIndex=format.indexOf("("),minusSignIndex=format.indexOf("-"),space="";return format.indexOf(" $")>-1?(space=" ",format=format.replace(" $","")):format.indexOf("$ ")>-1?(space=" ",format=format.replace("$ ","")):format=format.replace("$",""),output=formatNumber(n._value,format,roundingFunction),symbolIndex<=1?output.indexOf("(")>-1||output.indexOf("-")>-1?(output=output.split(""),spliceIndex=1,(symbolIndex<openParenIndex||symbolIndex<minusSignIndex)&&(spliceIndex=0),output.splice(spliceIndex,0,languages[currentLanguage].currency.symbol+space),output=output.join("")):output=languages[currentLanguage].currency.symbol+space+output:output.indexOf(")")>-1?(output=output.split(""),output.splice(-1,0,space+languages[currentLanguage].currency.symbol),output=output.join("")):output=output+space+languages[currentLanguage].currency.symbol,output}function formatPercentage(n,format,roundingFunction){var output,space="",value=100*n._value;return format.indexOf(" %")>-1?(space=" ",format=format.replace(" %","")):format=format.replace("%",""),output=formatNumber(value,format,roundingFunction),output.indexOf(")")>-1?(output=output.split(""),output.splice(-1,0,space+"%"),output=output.join("")):output=output+space+"%",output}function formatTime(n){var hours=Math.floor(n._value/60/60),minutes=Math.floor((n._value-60*hours*60)/60),seconds=Math.round(n._value-60*hours*60-60*minutes);return hours+":"+(minutes<10?"0"+minutes:minutes)+":"+(seconds<10?"0"+seconds:seconds)}function unformatTime(string){var timeArray=string.split(":"),seconds=0;return 3===timeArray.length?(seconds+=60*Number(timeArray[0])*60,seconds+=60*Number(timeArray[1]),seconds+=Number(timeArray[2])):2===timeArray.length&&(seconds+=60*Number(timeArray[0]),seconds+=Number(timeArray[1])),Number(seconds)}function formatNumber(value,format,roundingFunction){var min,max,power,w,precision,thousands,negP=!1,signed=!1,optDec=!1,abbr="",abbrK=!1,abbrM=!1,abbrB=!1,abbrT=!1,abbrForce=!1,bytes="",ord="",abs=Math.abs(value),suffixes=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],d="",neg=!1;if(0===value&&null!==zeroFormat)return zeroFormat;if(format.indexOf("(")>-1?(negP=!0,format=format.slice(1,-1)):format.indexOf("+")>-1&&(signed=!0,format=format.replace(/\+/g,"")),format.indexOf("a")>-1&&(abbrK=format.indexOf("aK")>=0,abbrM=format.indexOf("aM")>=0,abbrB=format.indexOf("aB")>=0,abbrT=format.indexOf("aT")>=0,abbrForce=abbrK||abbrM||abbrB||abbrT,format.indexOf(" a")>-1?(abbr=" ",format=format.replace(" a","")):format=format.replace("a",""),abs>=Math.pow(10,12)&&!abbrForce||abbrT?(abbr+=languages[currentLanguage].abbreviations.trillion,value/=Math.pow(10,12)):abs<Math.pow(10,12)&&abs>=Math.pow(10,9)&&!abbrForce||abbrB?(abbr+=languages[currentLanguage].abbreviations.billion,value/=Math.pow(10,9)):abs<Math.pow(10,9)&&abs>=Math.pow(10,6)&&!abbrForce||abbrM?(abbr+=languages[currentLanguage].abbreviations.million,value/=Math.pow(10,6)):(abs<Math.pow(10,6)&&abs>=Math.pow(10,3)&&!abbrForce||abbrK)&&(abbr+=languages[currentLanguage].abbreviations.thousand,value/=Math.pow(10,3))),format.indexOf("b")>-1)for(format.indexOf(" b")>-1?(bytes=" ",format=format.replace(" b","")):format=format.replace("b",""),power=0;power<=suffixes.length;power++)if(min=Math.pow(1024,power),max=Math.pow(1024,power+1),value>=min&&value<max){bytes+=suffixes[power],min>0&&(value/=min);break}return format.indexOf("o")>-1&&(format.indexOf(" o")>-1?(ord=" ",format=format.replace(" o","")):format=format.replace("o",""),ord+=languages[currentLanguage].ordinal(value)),format.indexOf("[.]")>-1&&(optDec=!0,format=format.replace("[.]",".")),w=value.toString().split(".")[0],precision=format.split(".")[1],thousands=format.indexOf(","),precision?(precision.indexOf("[")>-1?(precision=precision.replace("]",""),precision=precision.split("["),d=toFixed(value,precision[0].length+precision[1].length,roundingFunction,precision[1].length)):d=toFixed(value,precision.length,roundingFunction),w=d.split(".")[0],d=d.split(".")[1].length?languages[currentLanguage].delimiters.decimal+d.split(".")[1]:"",optDec&&0===Number(d.slice(1))&&(d="")):w=toFixed(value,null,roundingFunction),w.indexOf("-")>-1&&(w=w.slice(1),neg=!0),thousands>-1&&(w=w.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+languages[currentLanguage].delimiters.thousands)),0===format.indexOf(".")&&(w=""),(negP&&neg?"(":"")+(!negP&&neg?"-":"")+(!neg&&signed?"+":"")+w+d+(ord?ord:"")+(abbr?abbr:"")+(bytes?bytes:"")+(negP&&neg?")":"")}function loadLanguage(key,values){languages[key]=values}function multiplier(x){var parts=x.toString().split(".");return parts.length<2?1:Math.pow(10,parts[1].length)}function correctionFactor(){var args=Array.prototype.slice.call(arguments);return args.reduce(function(prev,next){var mp=multiplier(prev),mn=multiplier(next);return mp>mn?mp:mn},-(1/0))}var numeral,VERSION="1.5.3",languages={},currentLanguage="en",zeroFormat=null,defaultFormat="0,0",hasModule="undefined"!=typeof module&&module.exports;numeral=function(input){return numeral.isNumeral(input)?input=input.value():0===input||"undefined"==typeof input?input=0:Number(input)||(input=numeral.fn.unformat(input)),new Numeral(Number(input))},numeral.version=VERSION,numeral.isNumeral=function(obj){return obj instanceof Numeral},numeral.language=function(key,values){if(!key)return currentLanguage;if(key&&!values){if(!languages[key])throw new Error("Unknown language : "+key);currentLanguage=key}return!values&&languages[key]||loadLanguage(key,values),numeral},numeral.languageData=function(key){if(!key)return languages[currentLanguage];if(!languages[key])throw new Error("Unknown language : "+key);return languages[key]},numeral.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(number){var b=number%10;return 1===~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$"}}),numeral.zeroFormat=function(format){zeroFormat="string"==typeof format?format:null},numeral.defaultFormat=function(format){defaultFormat="string"==typeof format?format:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(callback,opt_initialValue){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof callback)throw new TypeError(callback+" is not a function");var index,value,length=this.length>>>0,isValueSet=!1;for(1<arguments.length&&(value=opt_initialValue,isValueSet=!0),index=0;length>index;++index)this.hasOwnProperty(index)&&(isValueSet?value=callback(value,this[index],index,this):(value=this[index],isValueSet=!0));if(!isValueSet)throw new TypeError("Reduce of empty array with no initial value");return value}),numeral.fn=Numeral.prototype={clone:function(){return numeral(this)},format:function(inputString,roundingFunction){return formatNumeral(this,inputString?inputString:defaultFormat,void 0!==roundingFunction?roundingFunction:Math.round)},unformat:function(inputString){return"[object Number]"===Object.prototype.toString.call(inputString)?inputString:unformatNumeral(this,inputString?inputString:defaultFormat)},value:function(){return this._value},valueOf:function(){return this._value},set:function(value){return this._value=Number(value),this},add:function(value){function cback(accum,curr,currI,O){return accum+corrFactor*curr}var corrFactor=correctionFactor.call(null,this._value,value);return this._value=[this._value,value].reduce(cback,0)/corrFactor,this},subtract:function(value){function cback(accum,curr,currI,O){return accum-corrFactor*curr}var corrFactor=correctionFactor.call(null,this._value,value);return this._value=[value].reduce(cback,this._value*corrFactor)/corrFactor,this},multiply:function(value){function cback(accum,curr,currI,O){var corrFactor=correctionFactor(accum,curr);return accum*corrFactor*(curr*corrFactor)/(corrFactor*corrFactor)}return this._value=[this._value,value].reduce(cback,1),this},divide:function(value){function cback(accum,curr,currI,O){var corrFactor=correctionFactor(accum,curr);return accum*corrFactor/(curr*corrFactor)}return this._value=[this._value,value].reduce(cback),this},difference:function(value){return Math.abs(numeral(this._value).subtract(value).value())}},hasModule&&(module.exports=numeral),"undefined"==typeof ender&&(this.numeral=numeral),__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return numeral}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}).call(this)}).call(window)}});